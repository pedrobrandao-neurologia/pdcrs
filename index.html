
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PD-CRS - Calculadora de Pontua√ß√£o</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .score-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }
        .test-section {
            background: #f8f9fa;
            border-left: 4px solid #007bff;
            padding: 20px;
            margin: 15px 0;
            border-radius: 8px;
        }
        .word-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }
        .word-item {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .word-item:hover {
            border-color: #007bff;
            transform: translateY(-2px);
        }
        .word-item.selected {
            background: #007bff;
            color: white;
            border-color: #0056b3;
        }
        .results-section {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
        }
        .percentile-badge {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            margin: 5px;
        }
        .naming-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }
        .attention-item, .memory-item {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .attention-item:hover, .memory-item:hover {
            border-color: #007bff;
        }
        .attention-item.selected, .memory-item.selected {
            background: #007bff;
            color: white;
            border-color: #0056b3;
        }
        .fluency-counter {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
        }
        
        /* Melhorar checkboxes do rel√≥gio */
        .clock-checkbox-item {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 12px 15px;
            margin: 8px 0;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .clock-checkbox-item:hover {
            border-color: #007bff;
            background-color: #f8f9fa;
        }
        
        .clock-checkbox-item.selected {
            background: #007bff;
            color: white;
            border-color: #0056b3;
        }
        
        .clock-checkbox-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            transform: scale(1.2);
        }
        
        .clock-checkbox-item label {
            cursor: pointer;
            margin: 0;
            font-weight: 500;
            flex: 1;
        }
        
        /* Escala de cores baseada na AACN para classifica√ß√£o de escores */
        /* DESEMPENHO PRESERVADO/SUPERIOR (tons de verde e azul) */
        .score-exceptionally-high {
            background-color: #155724 !important;  /* Verde muito escuro */
            color: white;
            border: 2px solid #0f4419;
        }
        .score-above-average {
            background-color: #28a745 !important;  /* Verde m√©dio */
            color: white;
            border: 2px solid #1e7e34;
        }
        .score-high-average {
            background-color: #40c463 !important;  /* Verde claro */
            color: white;
            border: 2px solid #28a745;
        }
        .score-average {
            background-color: #007bff !important;  /* Azul (neutro) */
            color: white;
            border: 2px solid #0056b3;
        }
        
        /* DESEMPENHO COMPROMETIDO/DEFICIT√ÅRIO (tons de amarelo, laranja e vermelho) */
        .score-low-average {
            background-color: #ffc107 !important;  /* Amarelo (aten√ß√£o) */
            color: #000;
            font-weight: bold;
            border: 2px solid #e0a800;
        }
        .score-below-average {
            background-color: #fd7e14 !important;  /* Laranja (preocupante) */
            color: white;
            font-weight: bold;
            border: 2px solid #dc6406;
        }
        .score-exceptionally-low {
            background-color: #dc3545 !important;  /* Vermelho (d√©ficit) */
            color: white;
            font-weight: bold;
            border: 2px solid #bd2130;
        }
        
        .interpretation-label {
            font-size: 0.85em;
            padding: 4px 8px;
            border-radius: 12px;
            display: inline-block;
            margin-left: 10px;
        }
        
        /* Melhorar visibilidade das cores na tabela de subtestes */
        #subtestResults tr {
            border: 3px solid transparent;
            transition: all 0.3s ease;
        }
        
        /* DESEMPENHO PRESERVADO/SUPERIOR */
        #subtestResults tr.score-exceptionally-high td {
            background-color: #155724 !important;  /* Verde muito escuro */
            color: white !important;
            font-weight: bold;
            border: 2px solid #0f4419;
        }
        
        #subtestResults tr.score-above-average td {
            background-color: #28a745 !important;  /* Verde m√©dio */
            color: white !important;
            font-weight: bold;
            border: 2px solid #1e7e34;
        }
        
        #subtestResults tr.score-high-average td {
            background-color: #40c463 !important;  /* Verde claro */
            color: white !important;
            font-weight: bold;
            border: 2px solid #28a745;
        }
        
        #subtestResults tr.score-average td {
            background-color: #007bff !important;  /* Azul neutro */
            color: white !important;
            font-weight: normal;
            border: 2px solid #0056b3;
        }
        
        /* DESEMPENHO COMPROMETIDO/DEFICIT√ÅRIO */
        #subtestResults tr.score-low-average td {
            background-color: #ffc107 !important;  /* Amarelo - aten√ß√£o */
            color: #000 !important;
            font-weight: bold;
            border: 2px solid #e0a800;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        #subtestResults tr.score-below-average td {
            background-color: #fd7e14 !important;  /* Laranja - preocupante */
            color: white !important;
            font-weight: bold;
            border: 2px solid #dc6406;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        }
        
        #subtestResults tr.score-exceptionally-low td {
            background-color: #dc3545 !important;  /* Vermelho - d√©ficit */
            color: white !important;
            font-weight: bold;
            border: 2px solid #bd2130;
            box-shadow: 0 3px 8px rgba(0,0,0,0.4);
        }
        
        /* Hover effects para melhor interatividade */
        #subtestResults tr:hover td {
            transform: scale(1.02);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3) !important;
        }
        
        /* Estilos para badges da legenda */
        .badge {
            padding: 8px 12px;
            font-size: 0.75em;
            margin: 2px;
            border-radius: 6px;
            display: inline-block;
        }
        
        /* Destaque visual para √°reas comprometidas */
        .score-low-average, .score-below-average, .score-exceptionally-low {
            animation: subtle-pulse 2s infinite;
        }

        @keyframes subtle-pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.85; }
        }

        /* =============================================
           CAIXAS DE INSTRU√á√ÉO AO PACIENTE E PONTUA√á√ÉO
           ============================================= */

        /* Caixa de instru√ß√£o para leitura ao paciente */
        .patient-instruction {
            background: linear-gradient(135deg, #fff8e1 0%, #fff3cd 100%);
            border: 2px solid #ffc107;
            border-left: 6px solid #e65100;
            border-radius: 8px;
            padding: 14px 18px;
            margin: 10px 0 12px 0;
        }
        .patient-instruction-header {
            font-weight: bold;
            font-size: 0.82em;
            color: #e65100;
            text-transform: uppercase;
            letter-spacing: 0.6px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .patient-instruction p {
            margin: 6px 0 0 0;
            font-style: italic;
            color: #37474f;
            line-height: 1.65;
        }
        .patient-instruction p strong {
            font-style: normal;
            color: #bf360c;
        }
        .patient-instruction .trial-break {
            border-top: 1px dashed #ffc107;
            margin: 10px 0;
            padding-top: 10px;
        }

        /* Nota de procedimento para o examinador */
        .examiner-note {
            background: #f3e5f5;
            border-left: 5px solid #7b1fa2;
            border-radius: 0 6px 6px 0;
            padding: 9px 14px;
            margin: 8px 0;
            font-size: 0.9em;
            color: #4a148c;
            line-height: 1.5;
        }
        .examiner-note strong {
            color: #4a148c;
        }

        /* Caixa de crit√©rios de pontua√ß√£o */
        .scoring-guide {
            background: linear-gradient(135deg, #e3f2fd 0%, #e8eaf6 100%);
            border: 2px solid #1976d2;
            border-left: 6px solid #0d47a1;
            border-radius: 8px;
            padding: 14px 18px;
            margin: 0 0 14px 0;
        }
        .scoring-guide-header {
            font-weight: bold;
            font-size: 0.82em;
            color: #0d47a1;
            text-transform: uppercase;
            letter-spacing: 0.6px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .scoring-guide ul {
            margin: 4px 0 0 0;
            padding-left: 20px;
        }
        .scoring-guide ul li {
            margin: 5px 0;
            color: #1a237e;
            line-height: 1.55;
        }
        .scoring-guide ul li strong {
            color: #0d47a1;
        }
        .score-pill {
            display: inline-block;
            background: #0d47a1;
            color: white;
            padding: 1px 8px;
            border-radius: 10px;
            font-weight: bold;
            font-size: 0.88em;
        }
        .stop-rule {
            background: #ffebee;
            border: 1px solid #ef9a9a;
            border-radius: 4px;
            padding: 6px 10px;
            margin-top: 6px;
            color: #b71c1c;
            font-weight: bold;
            font-size: 0.9em;
        }

        /* Caixa de treino */
        .training-box {
            background: #e8f5e9;
            border: 1px dashed #4caf50;
            border-radius: 6px;
            padding: 10px 14px;
            margin: 8px 0;
            font-size: 0.9em;
        }
        .training-box strong {
            color: #1b5e20;
        }

        /* Separador visual entre tentativas */
        .trial-header {
            background: #546e7a;
            color: white;
            padding: 6px 14px;
            border-radius: 6px;
            font-weight: bold;
            font-size: 0.9em;
            margin: 14px 0 8px 0;
            display: inline-block;
        }

        @media print {
            .patient-instruction { border: 2px solid #999; background: #fffde7; }
            .scoring-guide { border: 2px solid #555; background: #e3f2fd; }
            .examiner-note { background: #f5f5f5; }
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <div class="col-12">
                <div class="text-center py-4">
                    <h1 class="display-4 text-primary">PD-CRS</h1>
                    <p class="lead">Escala de Avalia√ß√£o Cognitiva da Doen√ßa de Parkinson</p>
                </div>

                <!-- Dados do Paciente -->
                <div class="card mb-4">
                    <div class="card-header bg-primary text-white">
                        <h3>Dados do Paciente</h3>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <label for="patientName" class="form-label">Nome:</label>
                                <input type="text" class="form-control" id="patientName">
                            </div>
                            <div class="col-md-2">
                                <label for="age" class="form-label">Idade:</label>
                                <input type="number" class="form-control" id="age" min="20" max="94" onchange="calculateScores()">
                            </div>
                            <div class="col-md-2">
                                <label for="education" class="form-label">Escolaridade (anos):</label>
                                <input type="number" class="form-control" id="education" min="0" max="25" onchange="calculateScores()">
                            </div>
                            <div class="col-md-2">
                                <label for="sex" class="form-label">Sexo:</label>
                                <select class="form-control" id="sex" onchange="calculateScores()">
                                    <option value="">Selecione</option>
                                    <option value="0">Masculino</option>
                                    <option value="1">Feminino</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 1. Mem√≥ria Verbal Imediata -->
                <div class="test-section">
                    <h4>1. Mem√≥ria Verbal com Evoca√ß√£o Livre Imediata (0-12 pontos)</h4>

                    <div class="scoring-guide">
                        <div class="scoring-guide-header">üìã Como Pontuar ‚Äî Instru√ß√µes ao Examinador</div>
                        <ul>
                            <li>Leia cada palavra em voz alta no ritmo de <strong>uma palavra por segundo</strong>, sem entoa√ß√£o especial.</li>
                            <li>Realize <strong>3 tentativas</strong> consecutivas com a mesma lista de 12 palavras.</li>
                            <li>Marque <span class="score-pill">1 ponto</span> para cada palavra recordada corretamente em cada tentativa.</li>
                            <li><strong>N√£o aceitar:</strong> palavras incorretas, intrus√µes (palavras que n√£o est√£o na lista), ou repeti√ß√µes dentro da mesma tentativa.</li>
                            <li>A ordem de evoca√ß√£o <strong>n√£o importa</strong> ‚Äî o paciente pode dizer as palavras em qualquer ordem.</li>
                            <li>O <strong>escore final deste subteste</strong> √© a <strong>maior pontua√ß√£o</strong> entre as tr√™s tentativas (m√°x. 12).</li>
                        </ul>
                    </div>

                    <div class="mb-3">
                        <span class="trial-header">‚ñ∂ TENTATIVA 1</span>
                        <div class="patient-instruction">
                            <div class="patient-instruction-header">üîä Leia ao Paciente ‚Äî 1¬™ Tentativa</div>
                            <p>"Eu vou ler uma lista de palavras e, quando finalizar, quero que voc√™ repita o maior n√∫mero de palavras que puder se recordar. <strong>N√£o precisa ser na mesma ordem da minha leitura.</strong> Alguma d√∫vida? Podemos come√ßar?"</p>
                        </div>
                        <div class="examiner-note">‚ñ∂ Leia as 12 palavras abaixo em voz alta, uma por segundo. Ao concluir, aguarde em sil√™ncio as respostas do paciente. Clique em cada palavra que o paciente recordar corretamente.</div>
                        <div class="word-grid" id="memory1">
                            <div class="word-item" onclick="toggleWord(this, 'mem1')" data-word="luz">LUZ</div>
                            <div class="word-item" onclick="toggleWord(this, 'mem1')" data-word="seda">SEDA</div>
                            <div class="word-item" onclick="toggleWord(this, 'mem1')" data-word="areia">AREIA</div>
                            <div class="word-item" onclick="toggleWord(this, 'mem1')" data-word="cilio">C√çLIO</div>
                            <div class="word-item" onclick="toggleWord(this, 'mem1')" data-word="arroz">ARROZ</div>
                            <div class="word-item" onclick="toggleWord(this, 'mem1')" data-word="gravata">GRAVATA</div>
                            <div class="word-item" onclick="toggleWord(this, 'mem1')" data-word="quadro">QUADRO</div>
                            <div class="word-item" onclick="toggleWord(this, 'mem1')" data-word="bicicleta">BICICLETA</div>
                            <div class="word-item" onclick="toggleWord(this, 'mem1')" data-word="estrela">ESTRELA</div>
                            <div class="word-item" onclick="toggleWord(this, 'mem1')" data-word="leao">LE√ÉO</div>
                            <div class="word-item" onclick="toggleWord(this, 'mem1')" data-word="anel">ANEL</div>
                            <div class="word-item" onclick="toggleWord(this, 'mem1')" data-word="perfume">PERFUME</div>
                        </div>
                        <p>Pontua√ß√£o Tentativa 1: <span id="score1">0</span>/12</p>
                    </div>

                    <div class="mb-3">
                        <span class="trial-header">‚ñ∂ TENTATIVA 2</span>
                        <div class="patient-instruction">
                            <div class="patient-instruction-header">üîä Leia ao Paciente ‚Äî 2¬™ Tentativa</div>
                            <p>"Agora vou ler as mesmas palavras e quero que se lembre da maior quantidade que puder se lembrar, <strong>inclusive as palavras que j√° foram ditas na primeira tentativa.</strong> N√£o importa a ordem das palavras, procure dizer todas elas incluindo aquelas que j√° foram recordadas na vez anterior. Pronto?"</p>
                        </div>
                        <div class="examiner-note">‚ñ∂ Leia novamente as 12 palavras no mesmo ritmo. Aguarde as respostas. Marque <em>todas</em> as palavras da lista que o paciente disser, mesmo que j√° tenham sido ditas na 1¬™ tentativa.</div>
                        <div class="word-grid" id="memory2">
                            <div class="word-item" onclick="toggleWord(this, 'mem2')" data-word="luz">LUZ</div>
                            <div class="word-item" onclick="toggleWord(this, 'mem2')" data-word="seda">SEDA</div>
                            <div class="word-item" onclick="toggleWord(this, 'mem2')" data-word="areia">AREIA</div>
                            <div class="word-item" onclick="toggleWord(this, 'mem2')" data-word="cilio">C√çLIO</div>
                            <div class="word-item" onclick="toggleWord(this, 'mem2')" data-word="arroz">ARROZ</div>
                            <div class="word-item" onclick="toggleWord(this, 'mem2')" data-word="gravata">GRAVATA</div>
                            <div class="word-item" onclick="toggleWord(this, 'mem2')" data-word="quadro">QUADRO</div>
                            <div class="word-item" onclick="toggleWord(this, 'mem2')" data-word="bicicleta">BICICLETA</div>
                            <div class="word-item" onclick="toggleWord(this, 'mem2')" data-word="estrela">ESTRELA</div>
                            <div class="word-item" onclick="toggleWord(this, 'mem2')" data-word="leao">LE√ÉO</div>
                            <div class="word-item" onclick="toggleWord(this, 'mem2')" data-word="anel">ANEL</div>
                            <div class="word-item" onclick="toggleWord(this, 'mem2')" data-word="perfume">PERFUME</div>
                        </div>
                        <p>Pontua√ß√£o Tentativa 2: <span id="score2">0</span>/12</p>
                    </div>

                    <div class="mb-3">
                        <span class="trial-header">‚ñ∂ TENTATIVA 3</span>
                        <div class="patient-instruction">
                            <div class="patient-instruction-header">üîä Leia ao Paciente ‚Äî 3¬™ Tentativa</div>
                            <p>"Agora, vou ler as mesmas palavras pela terceira vez e quero que se lembre da maior quantidade que puder se lembrar, <strong>inclusive as palavras que j√° foram ditas nas tentativas anteriores.</strong> N√£o importa a ordem das palavras, procure dizer todas elas incluindo aquelas que j√° foram recordadas na vez anterior. Pronto?"</p>
                        </div>
                        <div class="examiner-note">‚ñ∂ Leia as 12 palavras pela terceira e √∫ltima vez. Aguarde as respostas. Marque todas as palavras da lista que o paciente recordar corretamente.</div>
                        <div class="word-grid" id="memory3">
                            <div class="word-item" onclick="toggleWord(this, 'mem3')" data-word="luz">LUZ</div>
                            <div class="word-item" onclick="toggleWord(this, 'mem3')" data-word="seda">SEDA</div>
                            <div class="word-item" onclick="toggleWord(this, 'mem3')" data-word="areia">AREIA</div>
                            <div class="word-item" onclick="toggleWord(this, 'mem3')" data-word="cilio">C√çLIO</div>
                            <div class="word-item" onclick="toggleWord(this, 'mem3')" data-word="arroz">ARROZ</div>
                            <div class="word-item" onclick="toggleWord(this, 'mem3')" data-word="gravata">GRAVATA</div>
                            <div class="word-item" onclick="toggleWord(this, 'mem3')" data-word="quadro">QUADRO</div>
                            <div class="word-item" onclick="toggleWord(this, 'mem3')" data-word="bicicleta">BICICLETA</div>
                            <div class="word-item" onclick="toggleWord(this, 'mem3')" data-word="estrela">ESTRELA</div>
                            <div class="word-item" onclick="toggleWord(this, 'mem3')" data-word="leao">LE√ÉO</div>
                            <div class="word-item" onclick="toggleWord(this, 'mem3')" data-word="anel">ANEL</div>
                            <div class="word-item" onclick="toggleWord(this, 'mem3')" data-word="perfume">PERFUME</div>
                        </div>
                        <p>Pontua√ß√£o Tentativa 3: <span id="score3">0</span>/12</p>
                    </div>

                    <div class="alert alert-info">
                        <strong>‚ö†Ô∏è Escore Final ‚Äî Maior Pontua√ß√£o entre as tr√™s tentativas: <span id="immediateMemoryScore">0</span>/12</strong>
                    </div>
                </div>

                <!-- 2. Nomea√ß√£o por Confronto Visual -->
                <div class="test-section">
                    <h4>2. Nomea√ß√£o por Confronto Visual (0-20 pontos)</h4>

                    <div class="patient-instruction">
                        <div class="patient-instruction-header">üîä Instru√ß√£o ao Paciente</div>
                        <p>"Vou lhe mostrar uma s√©rie de figuras. Para cada uma, quero que me diga o nome do que est√° vendo."</p>
                    </div>

                    <div class="scoring-guide">
                        <div class="scoring-guide-header">üìã Como Pontuar ‚Äî Instru√ß√µes ao Examinador</div>
                        <ul>
                            <li>Mostre os <strong>20 cart√µes consecutivos</strong>, um por vez.</li>
                            <li>Marque <span class="score-pill">1 ponto</span> para cada item nomeado corretamente (m√°x. 20).</li>
                            <li><strong>Aceitar qualquer sin√¥nimo</strong> listado na escala original (ex.: tartaruga / jaboti / c√°gado / tracaj√°; pipa / papagaio / arraia).</li>
                            <li><strong>N√£o h√° limite de tempo</strong> para a resposta.</li>
                            <li>Permitida <strong>apenas uma tentativa</strong> por item ‚Äî n√£o oferecer segunda chance.</li>
                            <li><strong>N√£o fornecer pistas sem√¢nticas nem fon√™micas</strong> (n√£o dizer categoria, letra inicial etc.).</li>
                            <li>Para os itens apresentados <em>em contexto</em> ‚Äî babador, fivela, crina, anzol, sino e casco ‚Äî o examinador <strong>pode apontar a parte espec√≠fica</strong> do desenho a ser nomeada.</li>
                            <li>Respostas descritivas ("coisa de pescar") sem nomear o objeto: <strong>n√£o pontuar</strong>.</li>
                        </ul>
                    </div>

                    <div class="examiner-note">‚ñ∂ Clique nos itens abaixo que o paciente nomeou corretamente (qualquer sin√¥nimo aceito).</div>
                    
                    <div class="naming-grid">
                        <div class="word-item" onclick="toggleNaming(this)" data-item="babador">BABADOR</div>
                        <div class="word-item" onclick="toggleNaming(this)" data-item="vela">VELA</div>
                        <div class="word-item" onclick="toggleNaming(this)" data-item="cerejas">CEREJAS/MA√á√ÉS</div>
                        <div class="word-item" onclick="toggleNaming(this)" data-item="banqueta">BANQUETA/BANQUINHO</div>
                        <div class="word-item" onclick="toggleNaming(this)" data-item="ancora">√ÇNCORA</div>
                        <div class="word-item" onclick="toggleNaming(this)" data-item="tartaruga">TARTARUGA/JABOTI</div>
                        <div class="word-item" onclick="toggleNaming(this)" data-item="pipa">PIPA/PAPAGAIO</div>
                        <div class="word-item" onclick="toggleNaming(this)" data-item="aquario">AQU√ÅRIO</div>
                        <div class="word-item" onclick="toggleNaming(this)" data-item="lampada">L√ÇMPADA</div>
                        <div class="word-item" onclick="toggleNaming(this)" data-item="violao">VIOL√ÉO/GUITARRA</div>
                        <div class="word-item" onclick="toggleNaming(this)" data-item="fivela">FIVELA</div>
                        <div class="word-item" onclick="toggleNaming(this)" data-item="crina">CRINA/JUBA</div>
                        <div class="word-item" onclick="toggleNaming(this)" data-item="anzol">ANZOL</div>
                        <div class="word-item" onclick="toggleNaming(this)" data-item="chave">CHAVE DE FENDA</div>
                        <div class="word-item" onclick="toggleNaming(this)" data-item="anteparo">ANTEPARO/BIOMBO</div>
                        <div class="word-item" onclick="toggleNaming(this)" data-item="alfinete">ALFINETE</div>
                        <div class="word-item" onclick="toggleNaming(this)" data-item="sino">SINO/GUIZO</div>
                        <div class="word-item" onclick="toggleNaming(this)" data-item="casco">CASCO/PATA</div>
                        <div class="word-item" onclick="toggleNaming(this)" data-item="extintor">EXTINTOR</div>
                        <div class="word-item" onclick="toggleNaming(this)" data-item="fechadura">FECHADURA/TRINCO</div>
                    </div>
                    
                    <div class="alert alert-info">
                        <strong>Pontua√ß√£o Nomea√ß√£o: <span id="namingScore">0</span>/20</strong>
                    </div>
                </div>

                <!-- 3. Aten√ß√£o Sustentada -->
                <div class="test-section">
                    <h4>3. Aten√ß√£o Sustentada (0-10 pontos)</h4>

                    <div class="patient-instruction">
                        <div class="patient-instruction-header">üîä Leia ao Paciente ‚Äî Instru√ß√£o Geral</div>
                        <p>"Eu vou ler uma sequ√™ncia de n√∫meros e letras. Quando eu acabar, quero que me diga <strong>quantas letras</strong> voc√™ ouviu. Preste bastante aten√ß√£o, pois n√£o posso repetir."</p>
                        <div class="trial-break"></div>
                        <p><strong>Treino (leia em voz alta e aguarde a resposta):</strong></p>
                        <p>"Por exemplo, vou dizer: <strong>2 ‚Äî L ‚Äî T.</strong> Quantas letras tem?" <em>(aguardar resposta: 2 letras)</em> "Muito bem! Se eu disser <strong>8 ‚Äî A ‚Äî 9,</strong> quantas letras tem?" <em>(aguardar resposta: 1 letra)</em> "Ok! Vamos come√ßar?"</p>
                    </div>

                    <div class="scoring-guide">
                        <div class="scoring-guide-header">üìã Como Pontuar ‚Äî Instru√ß√µes ao Examinador</div>
                        <ul>
                            <li>Leia cada sequ√™ncia em voz alta no ritmo de <strong>um item por segundo</strong>, sem enfatizar letras ou n√∫meros.</li>
                            <li><strong>N√£o repetir</strong> nenhuma sequ√™ncia ap√≥s a leitura.</li>
                            <li>Realize os <strong>2 itens de treino</strong> (exemplos acima) antes de iniciar o teste formal.</li>
                            <li>Marque <span class="score-pill">1 ponto</span> para cada sequ√™ncia do teste em que o paciente indicar o n√∫mero correto de letras.</li>
                            <li>H√° <strong>10 sequ√™ncias de teste</strong> divididas em 5 n√≠veis de complexidade crescente (2 s√©ries por n√≠vel).</li>
                            <li>O teste <strong>n√£o tem regra de parada</strong> ‚Äî aplique todas as 10 sequ√™ncias.</li>
                            <li>Respostas parciais ou incorretas: <strong>n√£o pontuar</strong> (resposta deve ser exatamente o n√∫mero correto de letras).</li>
                        </ul>
                    </div>

                    <div class="examiner-note">‚ñ∂ Clique nas sequ√™ncias em que o paciente respondeu corretamente (n√∫mero exato de letras).</div>
                    
                    <div class="attention-item" onclick="toggleAttention(this)" data-sequence="2P654" data-answer="1">
                        <strong>2 P 6 5 4</strong> ‚Üí Resposta correta: 1 letra
                    </div>
                    <div class="attention-item" onclick="toggleAttention(this)" data-sequence="3A6KL" data-answer="3">
                        <strong>3 A 6 K L</strong> ‚Üí Resposta correta: 3 letras
                    </div>
                    <div class="attention-item" onclick="toggleAttention(this)" data-sequence="B904LT" data-answer="3">
                        <strong>B 9 0 4 L T</strong> ‚Üí Resposta correta: 3 letras
                    </div>
                    <div class="attention-item" onclick="toggleAttention(this)" data-sequence="3CP573" data-answer="2">
                        <strong>3 C P 5 7 3</strong> ‚Üí Resposta correta: 2 letras
                    </div>
                    <div class="attention-item" onclick="toggleAttention(this)" data-sequence="395L4ZA" data-answer="3">
                        <strong>3 9 5 L 4 Z A</strong> ‚Üí Resposta correta: 3 letras
                    </div>
                    <div class="attention-item" onclick="toggleAttention(this)" data-sequence="I1ASQ41" data-answer="4">
                        <strong>I 1 A S Q 4 1</strong> ‚Üí Resposta correta: 4 letras
                    </div>
                    <div class="attention-item" onclick="toggleAttention(this)" data-sequence="75DA4TB2" data-answer="4">
                        <strong>7 5 D A 4 T B 2</strong> ‚Üí Resposta correta: 4 letras
                    </div>
                    <div class="attention-item" onclick="toggleAttention(this)" data-sequence="968437LC" data-answer="2">
                        <strong>9 6 8 4 3 7 L C</strong> ‚Üí Resposta correta: 2 letras
                    </div>
                    <div class="attention-item" onclick="toggleAttention(this)" data-sequence="Z49ATD384" data-answer="1">
                        <strong>Z 4 9 A T D 3 8 4</strong> ‚Üí Resposta correta: 1 letra
                    </div>
                    <div class="attention-item" onclick="toggleAttention(this)" data-sequence="95MD4SC3E" data-answer="5">
                        <strong>9 5 M D 4 S C 3 E</strong> ‚Üí Resposta correta: 5 letras
                    </div>
                    
                    <div class="alert alert-info">
                        <strong>Pontua√ß√£o Aten√ß√£o Sustentada: <span id="attentionScore">0</span>/10</strong>
                    </div>
                </div>

                <!-- 4. Mem√≥ria Operacional -->
                <div class="test-section">
                    <h4>4. Mem√≥ria Operacional (0-10 pontos)</h4>

                    <div class="patient-instruction">
                        <div class="patient-instruction-header">üîä Leia ao Paciente ‚Äî Instru√ß√£o Geral</div>
                        <p>"Vou ler uma lista de n√∫meros e letras. Quando terminar, quero que voc√™ repita <strong>primeiro os n√∫meros</strong> e <strong>depois as letras</strong>."</p>
                        <div class="trial-break"></div>
                        <p><strong>Treino (leia e aguarde a resposta antes de continuar):</strong></p>
                        <p>"Por exemplo, vou dizer: <strong>L ‚Äî 2 ‚Äî T.</strong> O que voc√™ responde?" <em>(resposta esperada: "2 ‚Äî L ‚Äî T")</em> "Muito bem! Mais uma vez: <strong>8 ‚Äî A ‚Äî 9.</strong>" <em>(resposta esperada: "8 ‚Äî 9 ‚Äî A")</em> "Muito bem! Podemos come√ßar?"</p>
                    </div>

                    <div class="scoring-guide">
                        <div class="scoring-guide-header">üìã Como Pontuar ‚Äî Instru√ß√µes ao Examinador</div>
                        <ul>
                            <li>Leia cada s√©rie em voz alta no ritmo de <strong>um item por segundo</strong>.</li>
                            <li>O paciente deve repetir <strong>primeiro todos os n√∫meros em ordem crescente</strong>, depois <strong>todas as letras em qualquer ordem</strong>.</li>
                            <li>Marque <span class="score-pill">1 ponto</span> para cada s√©rie em que o paciente fornecer a resposta completamente correta.</li>
                            <li>Qualquer erro na ordem dos n√∫meros ou omiss√£o de elemento: <strong>n√£o pontuar</strong> aquela s√©rie.</li>
                            <li>Realize os <strong>2 itens de treino</strong> antes de iniciar o teste formal. O treino <strong>n√£o √© pontuado</strong>.</li>
                            <li class="stop-rule">üõë REGRA DE PARADA: Interromper o teste quando o paciente errar <strong>2 s√©ries consecutivas</strong>. As s√©ries restantes recebem 0 ponto.</li>
                        </ul>
                    </div>

                    <div class="examiner-note">‚ñ∂ Clique nas s√©ries em que o paciente respondeu corretamente (n√∫meros em ordem crescente primeiro, depois as letras).</div>
                    
                    <div class="memory-item" onclick="toggleMemory(this)" data-sequence="GM" data-answer="G M">
                        <strong>G 8 M</strong> ‚Üí Resposta correta: 8 G M
                    </div>
                    <div class="memory-item" onclick="toggleMemory(this)" data-sequence="9I6" data-answer="9 6 I">
                        <strong>9 I 6</strong> ‚Üí Resposta correta: 9 6 I
                    </div>
                    <div class="memory-item" onclick="toggleMemory(this)" data-sequence="3M" data-answer="3 M">
                        <strong>3 M</strong> ‚Üí Resposta correta: 3 M
                    </div>
                    <div class="memory-item" onclick="toggleMemory(this)" data-sequence="7P" data-answer="7 P">
                        <strong>7 P</strong> ‚Üí Resposta correta: 7 P
                    </div>
                    <div class="memory-item" onclick="toggleMemory(this)" data-sequence="M64NI" data-answer="6 4 M N I">
                        <strong>M 6 4 N I</strong> ‚Üí Resposta correta: 6 4 M N I
                    </div>
                    <div class="memory-item" onclick="toggleMemory(this)" data-sequence="35SGC" data-answer="3 5 S G C">
                        <strong>3 5 S G C</strong> ‚Üí Resposta correta: 3 5 S G C
                    </div>
                    <div class="memory-item" onclick="toggleMemory(this)" data-sequence="T04A" data-answer="0 4 T A">
                        <strong>T 0 4 A</strong> ‚Üí Resposta correta: 0 4 T A
                    </div>
                    <div class="memory-item" onclick="toggleMemory(this)" data-sequence="7V6J" data-answer="7 6 V J">
                        <strong>7 V 6 J</strong> ‚Üí Resposta correta: 7 6 V J
                    </div>
                    <div class="memory-item" onclick="toggleMemory(this)" data-sequence="1R9VB3" data-answer="1 9 3 R V B">
                        <strong>1 R 9 V B 3</strong> ‚Üí Resposta correta: 1 9 3 R V B
                    </div>
                    <div class="memory-item" onclick="toggleMemory(this)" data-sequence="M274Z9" data-answer="2 7 4 9 M Z">
                        <strong>M 2 7 4 Z 9</strong> ‚Üí Resposta correta: 2 7 4 9 M Z
                    </div>
                    
                    <div class="alert alert-info">
                        <strong>Pontua√ß√£o Mem√≥ria Operacional: <span id="workingMemoryScore">0</span>/10</strong>
                    </div>
                </div>

                <!-- 5. Desenho do Rel√≥gio - Interface Melhorada -->
                <div class="test-section">
                    <h4>5. Desenho do Rel√≥gio (Espont√¢neo) (0-10 pontos)</h4>

                    <div class="patient-instruction">
                        <div class="patient-instruction-header">üîä Leia ao Paciente</div>
                        <p>"Quero que voc√™ desenhe um rel√≥gio com <strong>todos os n√∫meros</strong>, com os ponteiros marcando <strong>dez horas e vinte e cinco minutos</strong>. O rel√≥gio deve ter um contorno e os dois ponteiros devem ser desenhados <strong>na forma de setas</strong>. Pode come√ßar."</p>
                    </div>

                    <div class="examiner-note">‚ñ∂ Entregue uma folha de papel em branco e um l√°pis ou caneta. N√£o forne√ßa modelo ou aux√≠lio. Quando conclu√≠do, avalie cada crit√©rio abaixo e clique nos que foram atendidos.</div>

                    <div class="scoring-guide">
                        <div class="scoring-guide-header">üìã Como Pontuar ‚Äî 10 Crit√©rios (1 ponto cada)</div>
                        <ul>
                            <li><strong>1. A figura parece um rel√≥gio</strong> ‚Äî o desenho √© reconhec√≠vel como um rel√≥gio (forma circular ou quadrada com caracter√≠sticas de rel√≥gio).</li>
                            <li><strong>2. O rel√≥gio n√£o √© dividido por linhas ou setores</strong> ‚Äî aus√™ncia de linhas internas que dividam o mostrador.</li>
                            <li><strong>3. H√° uma disposi√ß√£o sim√©trica dos n√∫meros</strong> ‚Äî os n√∫meros est√£o aproximadamente equidistantes e distribu√≠dos de forma sim√©trica ao redor do mostrador.</li>
                            <li><strong>4. Somente s√£o escritos n√∫meros no intervalo de 1 a 12</strong> ‚Äî n√£o h√° n√∫meros al√©m de 1‚Äì12 escritos dentro do rel√≥gio.</li>
                            <li><strong>5. Os n√∫meros das horas est√£o corretamente sequenciados</strong> ‚Äî os n√∫meros de 1 a 12 aparecem em ordem hor√°ria, sem invers√µes ou saltos.</li>
                            <li><strong>6. Somente dois ponteiros s√£o desenhados</strong> ‚Äî exatamente dois ponteiros (hora e minutos), nada mais.</li>
                            <li><strong>7. Os ponteiros s√£o representados como setas</strong> ‚Äî ambos os ponteiros t√™m ponta de seta (n√£o basta uma linha reta).</li>
                            <li><strong>8. O ponteiro das horas √© menor que o ponteiro dos minutos</strong> ‚Äî o ponteiro que indica "10h" deve ser visivelmente menor que o que indica "25min".</li>
                            <li><strong>9. Nenhuma palavra foi escrita</strong> ‚Äî aus√™ncia de qualquer texto al√©m dos n√∫meros das horas.</li>
                            <li><strong>10. O n√∫mero "25" n√£o foi desenhado</strong> ‚Äî o paciente n√£o escreveu "25" como n√∫mero avulso no mostrador para indicar os minutos.</li>
                        </ul>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="clock-checkbox-item" onclick="toggleClockItem(this, 'clock1')">
                                <input class="form-check-input" type="checkbox" id="clock1" onchange="updateClockScore()">
                                <label class="form-check-label" for="clock1">A figura parece um rel√≥gio</label>
                            </div>
                            <div class="clock-checkbox-item" onclick="toggleClockItem(this, 'clock2')">
                                <input class="form-check-input" type="checkbox" id="clock2" onchange="updateClockScore()">
                                <label class="form-check-label" for="clock2">O rel√≥gio n√£o √© dividido por linhas ou setores</label>
                            </div>
                            <div class="clock-checkbox-item" onclick="toggleClockItem(this, 'clock3')">
                                <input class="form-check-input" type="checkbox" id="clock3" onchange="updateClockScore()">
                                <label class="form-check-label" for="clock3">H√° uma disposi√ß√£o sim√©trica dos n√∫meros</label>
                            </div>
                            <div class="clock-checkbox-item" onclick="toggleClockItem(this, 'clock4')">
                                <input class="form-check-input" type="checkbox" id="clock4" onchange="updateClockScore()">
                                <label class="form-check-label" for="clock4">Somente n√∫meros de 1 a 12 est√£o escritos</label>
                            </div>
                            <div class="clock-checkbox-item" onclick="toggleClockItem(this, 'clock5')">
                                <input class="form-check-input" type="checkbox" id="clock5" onchange="updateClockScore()">
                                <label class="form-check-label" for="clock5">Os n√∫meros est√£o corretamente sequenciados</label>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="clock-checkbox-item" onclick="toggleClockItem(this, 'clock6')">
                                <input class="form-check-input" type="checkbox" id="clock6" onchange="updateClockScore()">
                                <label class="form-check-label" for="clock6">Somente dois ponteiros s√£o desenhados</label>
                            </div>
                            <div class="clock-checkbox-item" onclick="toggleClockItem(this, 'clock7')">
                                <input class="form-check-input" type="checkbox" id="clock7" onchange="updateClockScore()">
                                <label class="form-check-label" for="clock7">Os ponteiros s√£o representados como setas</label>
                            </div>
                            <div class="clock-checkbox-item" onclick="toggleClockItem(this, 'clock8')">
                                <input class="form-check-input" type="checkbox" id="clock8" onchange="updateClockScore()">
                                <label class="form-check-label" for="clock8">O ponteiro das horas √© menor que o dos minutos</label>
                            </div>
                            <div class="clock-checkbox-item" onclick="toggleClockItem(this, 'clock9')">
                                <input class="form-check-input" type="checkbox" id="clock9" onchange="updateClockScore()">
                                <label class="form-check-label" for="clock9">Nenhuma palavra foi escrita</label>
                            </div>
                            <div class="clock-checkbox-item" onclick="toggleClockItem(this, 'clock10')">
                                <input class="form-check-input" type="checkbox" id="clock10" onchange="updateClockScore()">
                                <label class="form-check-label" for="clock10">O n√∫mero "25" n√£o foi desenhado</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="alert alert-info">
                        <strong>Pontua√ß√£o Desenho do Rel√≥gio: <span id="clockDrawingScore">0</span>/10</strong>
                    </div>
                </div>

                <!-- 6. C√≥pia do Rel√≥gio - Interface Melhorada -->
                <div class="test-section">
                    <h4>6. C√≥pia do Desenho do Rel√≥gio (0-10 pontos)</h4>

                    <div class="patient-instruction">
                        <div class="patient-instruction-header">üîä Leia ao Paciente</div>
                        <p>"Agora, quero que voc√™ <strong>copie este rel√≥gio</strong> o mais parecido poss√≠vel."</p>
                    </div>

                    <div class="examiner-note">‚ñ∂ Apresente o cart√£o com o modelo do rel√≥gio. O paciente deve copi√°-lo em uma folha em branco. Avalie cada crit√©rio abaixo ao t√©rmino.</div>

                    <div class="scoring-guide">
                        <div class="scoring-guide-header">üìã Como Pontuar ‚Äî 10 Crit√©rios (1 ponto cada)</div>
                        <ul>
                            <li><strong>1. A figura parece um rel√≥gio</strong> ‚Äî o desenho √© reconhec√≠vel como rel√≥gio.</li>
                            <li><strong>2. O rel√≥gio n√£o √© dividido por linhas ou setores</strong> ‚Äî aus√™ncia de linhas internas dividindo o mostrador.</li>
                            <li><strong>3. H√° uma disposi√ß√£o sim√©trica dos n√∫meros</strong> ‚Äî n√∫meros aproximadamente equidistantes e distribu√≠dos simetricamente.</li>
                            <li><strong>4. Somente s√£o escritos n√∫meros no intervalo de 1 a 12</strong> ‚Äî apenas os n√∫meros 1‚Äì12 dentro do rel√≥gio.</li>
                            <li><strong>5. Os n√∫meros das horas est√£o corretamente sequenciados</strong> ‚Äî n√∫meros de 1 a 12 em ordem hor√°ria, sem invers√µes.</li>
                            <li><strong>6. Somente dois ponteiros s√£o desenhados</strong> ‚Äî exatamente dois ponteiros.</li>
                            <li><strong>7. Os ponteiros s√£o representados como setas</strong> ‚Äî ambos com ponta de seta.</li>
                            <li><strong>8. O ponteiro das horas √© menor que o ponteiro dos minutos</strong> ‚Äî diferen√ßa vis√≠vel de tamanho entre os dois ponteiros.</li>
                            <li><strong>9. Nenhuma palavra foi escrita</strong> ‚Äî aus√™ncia de texto al√©m dos n√∫meros das horas.</li>
                            <li><strong>10. O n√∫mero "25" n√£o foi desenhado</strong> ‚Äî o "25" n√£o aparece como n√∫mero avulso no mostrador.</li>
                        </ul>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="clock-checkbox-item" onclick="toggleClockItem(this, 'copy1')">
                                <input class="form-check-input" type="checkbox" id="copy1" onchange="updateCopyScore()">
                                <label class="form-check-label" for="copy1">A figura parece um rel√≥gio</label>
                            </div>
                            <div class="clock-checkbox-item" onclick="toggleClockItem(this, 'copy2')">
                                <input class="form-check-input" type="checkbox" id="copy2" onchange="updateCopyScore()">
                                <label class="form-check-label" for="copy2">O rel√≥gio n√£o √© dividido por linhas ou setores</label>
                            </div>
                            <div class="clock-checkbox-item" onclick="toggleClockItem(this, 'copy3')">
                                <input class="form-check-input" type="checkbox" id="copy3" onchange="updateCopyScore()">
                                <label class="form-check-label" for="copy3">H√° uma disposi√ß√£o sim√©trica dos n√∫meros</label>
                            </div>
                            <div class="clock-checkbox-item" onclick="toggleClockItem(this, 'copy4')">
                                <input class="form-check-input" type="checkbox" id="copy4" onchange="updateCopyScore()">
                                <label class="form-check-label" for="copy4">Somente n√∫meros de 1 a 12 est√£o escritos</label>
                            </div>
                            <div class="clock-checkbox-item" onclick="toggleClockItem(this, 'copy5')">
                                <input class="form-check-input" type="checkbox" id="copy5" onchange="updateCopyScore()">
                                <label class="form-check-label" for="copy5">Os n√∫meros est√£o corretamente sequenciados</label>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="clock-checkbox-item" onclick="toggleClockItem(this, 'copy6')">
                                <input class="form-check-input" type="checkbox" id="copy6" onchange="updateCopyScore()">
                                <label class="form-check-label" for="copy6">Somente dois ponteiros s√£o desenhados</label>
                            </div>
                            <div class="clock-checkbox-item" onclick="toggleClockItem(this, 'copy7')">
                                <input class="form-check-input" type="checkbox" id="copy7" onchange="updateCopyScore()">
                                <label class="form-check-label" for="copy7">Os ponteiros s√£o representados como setas</label>
                            </div>
                            <div class="clock-checkbox-item" onclick="toggleClockItem(this, 'copy8')">
                                <input class="form-check-input" type="checkbox" id="copy8" onchange="updateCopyScore()">
                                <label class="form-check-label" for="copy8">O ponteiro das horas √© menor que o dos minutos</label>
                            </div>
                            <div class="clock-checkbox-item" onclick="toggleClockItem(this, 'copy9')">
                                <input class="form-check-input" type="checkbox" id="copy9" onchange="updateCopyScore()">
                                <label class="form-check-label" for="copy9">Nenhuma palavra foi escrita</label>
                            </div>
                            <div class="clock-checkbox-item" onclick="toggleClockItem(this, 'copy10')">
                                <input class="form-check-input" type="checkbox" id="copy10" onchange="updateCopyScore()">
                                <label class="form-check-label" for="copy10">O n√∫mero "25" n√£o foi desenhado</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="alert alert-info">
                        <strong>Pontua√ß√£o C√≥pia do Rel√≥gio: <span id="clockCopyScore">0</span>/10</strong>
                    </div>
                </div>

                <!-- 7. Mem√≥ria Verbal Tardia -->
                <div class="test-section" id="delayedMemorySection">
                    <h4>7. Mem√≥ria Verbal de Evoca√ß√£o Livre Tardia (0-12 pontos)</h4>

                    <div class="patient-instruction">
                        <div class="patient-instruction-header">üîä Leia ao Paciente</div>
                        <p>"Quero que voc√™ tente se lembrar daquela lista de palavras que foi lida tr√™s vezes para voc√™ <strong>no in√≠cio deste teste</strong>. Tente se lembrar da maior quantidade de palavras que puder, em qualquer ordem."</p>
                    </div>

                    <div class="scoring-guide">
                        <div class="scoring-guide-header">üìã Como Pontuar ‚Äî Instru√ß√µes ao Examinador</div>
                        <ul>
                            <li>Aplicar este subteste <strong>ap√≥s os demais testes</strong> (rel√≥gio, flu√™ncias etc.), de modo a garantir um intervalo adequado desde a aprendizagem inicial.</li>
                            <li>Marque <span class="score-pill">1 ponto</span> para cada palavra da lista original corretamente recordada (m√°x. 12).</li>
                            <li><strong>N√£o fornecer pistas</strong> sem√¢nticas, fon√™micas ou de qualquer natureza.</li>
                            <li>N√£o aceitar: palavras que n√£o est√£o na lista original (intrus√µes) ou repeti√ß√µes da mesma palavra.</li>
                            <li>A ordem de evoca√ß√£o <strong>n√£o importa</strong>.</li>
                        </ul>
                    </div>

                    <div class="examiner-note">‚ñ∂ Clique nas palavras que o paciente recordar corretamente da lista aprendida no in√≠cio.</div>
                    
                    <div class="word-grid" id="delayedMemoryGrid">
                        <div class="word-item" onclick="toggleDelayed(this)" data-word="luz">LUZ</div>
                        <div class="word-item" onclick="toggleDelayed(this)" data-word="seda">SEDA</div>
                        <div class="word-item" onclick="toggleDelayed(this)" data-word="areia">AREIA</div>
                        <div class="word-item" onclick="toggleDelayed(this)" data-word="cilio">C√çLIO</div>
                        <div class="word-item" onclick="toggleDelayed(this)" data-word="arroz">ARROZ</div>
                        <div class="word-item" onclick="toggleDelayed(this)" data-word="gravata">GRAVATA</div>
                        <div class="word-item" onclick="toggleDelayed(this)" data-word="quadro">QUADRO</div>
                        <div class="word-item" onclick="toggleDelayed(this)" data-word="bicicleta">BICICLETA</div>
                        <div class="word-item" onclick="toggleDelayed(this)" data-word="estrela">ESTRELA</div>
                        <div class="word-item" onclick="toggleDelayed(this)" data-word="leao">LE√ÉO</div>
                        <div class="word-item" onclick="toggleDelayed(this)" data-word="anel">ANEL</div>
                        <div class="word-item" onclick="toggleDelayed(this)" data-word="perfume">PERFUME</div>
                    </div>
                    
                    <div class="alert alert-info">
                        <strong>Pontua√ß√£o Mem√≥ria Tardia: <span id="delayedMemoryScore">0</span>/12</strong>
                    </div>
                </div>

                <!-- 8. Flu√™ncia Verbal Alternada -->
                <div class="test-section">
                    <h4>8. Flu√™ncia Verbal Alternada (0-20 pontos)</h4>

                    <div class="patient-instruction">
                        <div class="patient-instruction-header">üîä Leia ao Paciente</div>
                        <p>"Durante um minuto, quero que me diga a maior quantidade de palavras que <strong>comecem com a letra 'S'</strong>, de maneira alternada com a maior quantidade poss√≠vel de <strong>itens do vestu√°rio</strong>. Voc√™ ir√° dizer algo que come√ßa com a letra 'S' e em seguida uma vestimenta. Depois outra palavra com 'S' e outra vestimenta. Lembre-se que as vestimentas podem come√ßar com qualquer letra. <strong>N√£o use nomes pr√≥prios.</strong> Far√° isto o mais rapidamente que puder por um minuto. Podemos come√ßar?"</p>
                    </div>

                    <div class="scoring-guide">
                        <div class="scoring-guide-header">üìã Como Pontuar ‚Äî Instru√ß√µes ao Examinador</div>
                        <ul>
                            <li>Marque <span class="score-pill">1 ponto</span> para cada resposta correta que <strong>mantenha a altern√¢ncia</strong> entre palavra iniciada por 'S' e item de vestu√°rio (m√°x. 20).</li>
                            <li><strong>Regra de altern√¢ncia:</strong> S ‚Üí vestu√°rio ‚Üí S ‚Üí vestu√°rio... A sequ√™ncia deve ser rigorosamente alternada.</li>
                            <li>Se o paciente <strong>quebrar a altern√¢ncia</strong> (ex.: dizer dois 'S' seguidos), a(s) resposta(s) que violam a sequ√™ncia <strong>n√£o s√£o pontuadas</strong>. A contagem retoma quando a altern√¢ncia for restabelecida corretamente.</li>
                            <li><strong>N√£o aceitar:</strong> nomes pr√≥prios (Jo√£o, Paris), a mesma palavra com termina√ß√£o diferente (sapo/sapa/sapinho), repeti√ß√µes.</li>
                            <li>Itens de vestu√°rio podem come√ßar com qualquer letra (camisa, t√™nis, luva etc.).</li>
                            <li>Marque exatamente <strong>60 segundos</strong> no cron√¥metro e interrompa ao fim do tempo.</li>
                            <li>Registre as respostas na tabela abaixo e depois insira o total de pares alternados corretos.</li>
                        </ul>
                    </div>

                    <div class="examiner-note">‚ñ∂ Marque o cron√¥metro em 60 segundos. Registre as palavras abaixo e conte os pares alternados corretos ao fim.</div>
                    
                    <div class="fluency-counter">
                        <label for="alternatedFluency" class="form-label">N√∫mero de respostas corretas alternadas:</label>
                        <input type="number" class="form-control" id="alternatedFluency" min="0" max="20" style="width: 100px;" onchange="updateAlternatedFluency()">
                    </div>
                    
                    <div class="alert alert-info">
                        <strong>Pontua√ß√£o Flu√™ncia Alternada: <span id="alternatedFluencyScore">0</span>/20</strong>
                    </div>
                </div>

                <!-- 9. Flu√™ncia Verbal de A√ß√µes -->
                <div class="test-section">
                    <h4>9. Flu√™ncia Verbal de A√ß√µes (0-30 pontos)</h4>

                    <div class="patient-instruction">
                        <div class="patient-instruction-header">üîä Leia ao Paciente</div>
                        <p>"Durante 60 segundos, quero que me diga o maior n√∫mero de <strong>coisas diferentes que as pessoas fazem</strong>. Eu n√£o quero que voc√™ use a mesma palavra com diferentes termina√ß√µes, como 'comer, comendo, comido'. Tamb√©m, me diga apenas palavras como <strong>'comer'</strong> ou <strong>'cheirar'</strong>, no lugar de uma frase ou senten√ßa (ex.: 'indo comer'). Quero somente as palavras. Entendeu? Podemos come√ßar?"</p>
                    </div>

                    <div class="scoring-guide">
                        <div class="scoring-guide-header">üìã Como Pontuar ‚Äî Instru√ß√µes ao Examinador</div>
                        <ul>
                            <li>Marque <span class="score-pill">1 ponto</span> para cada verbo (a√ß√£o) correto e √∫nico (m√°x. 30).</li>
                            <li>Aceitar <strong>verbos no infinitivo</strong> que representem claramente uma a√ß√£o humana (ex.: correr, dormir, cozinhar).</li>
                            <li><strong>N√£o aceitar:</strong> a mesma raiz verbal com termina√ß√µes diferentes (comer / comendo / comido conta como 1 resposta, apenas a primeira √© pontuada).</li>
                            <li><strong>N√£o aceitar:</strong> frases ou locu√ß√µes verbais ("ir ao mercado", "vou dormir").</li>
                            <li><strong>N√£o aceitar:</strong> substantivos que descrevem atividades mas n√£o s√£o verbos ("futebol", "nata√ß√£o").</li>
                            <li><strong>N√£o aceitar:</strong> repeti√ß√µes da mesma palavra j√° dita.</li>
                            <li>Marque exatamente <strong>60 segundos</strong> e interrompa ao fim do tempo.</li>
                            <li>Registre cada resposta para confer√™ncia posterior e insira o total de verbos corretos abaixo.</li>
                        </ul>
                    </div>

                    <div class="examiner-note">‚ñ∂ Marque 60 segundos no cron√¥metro. Anote as respostas do paciente e depois insira o total de a√ß√µes corretas.</div>
                    
                    <div class="fluency-counter">
                        <label for="actionFluency" class="form-label">N√∫mero de a√ß√µes corretas:</label>
                        <input type="number" class="form-control" id="actionFluency" min="0" max="30" style="width: 100px;" onchange="updateActionFluency()">
                    </div>
                    
                    <div class="alert alert-info">
                        <strong>Pontua√ß√£o Flu√™ncia de A√ß√µes: <span id="actionFluencyScore">0</span>/30</strong>
                    </div>
                </div>

                <!-- Resultados -->
                <div class="results-section">
                    <h3 class="text-center mb-4">Resultados da Avalia√ß√£o</h3>
                    
                    <div class="row">
                        <div class="col-md-4">
                            <div class="text-center">
                                <h4>Escore Frontal-Subcortical</h4>
                                <div class="display-4" id="frontalScore">0</div>
                                <small>/104 pontos</small>
                                <div class="mt-2">
                                    <span class="percentile-badge bg-primary" id="frontalPercentile">Percentil: --</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="text-center">
                                <h4>Escore Cortical Posterior</h4>
                                <div class="display-4" id="posteriorScore">0</div>
                                <small>/30 pontos</small>
                                <div class="mt-2">
                                    <span class="percentile-badge bg-success" id="posteriorPercentile">Percentil: --</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="text-center">
                                <h4>Escore Total PD-CRS</h4>
                                <div class="display-2 font-weight-bold" id="totalScore">0</div>
                                <small>/134 pontos</small>
                                <div class="mt-2">
                                    <span class="percentile-badge bg-warning text-dark" id="totalPercentile">Percentil: --</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row mt-4">
                        <div class="col-12">
                            <h5>Escores Normativos Ajustados:</h5>
                            <div class="row">
                                <div class="col-md-6">
                                    <p><strong>Z-Score Total:</strong> <span id="zScore">--</span></p>
                                    <p><strong>T-Score Total:</strong> <span id="tScore">--</span></p>
                                    <p><strong>Classifica√ß√£o AACN:</strong> <span id="classification">--</span></p>
                                </div>
                                <div class="col-md-6">
                                    <p><strong>Orienta√ß√£o Cl√≠nica:</strong> <span id="clinicalGuidance">--</span></p>
                                    <p><strong>Interpreta√ß√£o Geral:</strong> <span id="generalInterpretation">--</span></p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row mt-4">
                        <div class="col-12">
                            <h5>Detalhamento por Subteste:</h5>
                            
                            <!-- Legenda de cores -->
                            <div class="alert alert-info mb-3">
                                <h6><i class="fas fa-info-circle"></i> <strong>Legenda de Cores:</strong></h6>
                                <div class="row">
                                    <div class="col-md-6">
                                        <p class="mb-1"><strong>Desempenho Preservado/Superior:</strong></p>
                                        <span class="badge score-exceptionally-high me-2">Excepcionalmente Superior</span>
                                        <span class="badge score-above-average me-2">Acima da M√©dia</span>
                                        <span class="badge score-high-average me-2">M√©dia Superior</span>
                                        <span class="badge score-average me-2">M√©dia</span>
                                    </div>
                                    <div class="col-md-6">
                                        <p class="mb-1"><strong>Desempenho Comprometido/Deficit√°rio:</strong></p>
                                        <span class="badge score-low-average me-2">M√©dia Inferior</span>
                                        <span class="badge score-below-average me-2">Abaixo da M√©dia</span>
                                        <span class="badge score-exceptionally-low me-2">Excepcionalmente Inferior</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="table-responsive">
                                <table class="table table-dark table-striped">
                                    <thead>
                                        <tr>
                                            <th>Subteste</th>
                                            <th>Escore Bruto</th>
                                            <th>Escore Predito</th>
                                            <th>Z-Score</th>
                                            <th>Percentil</th>
                                            <th>Classifica√ß√£o AACN</th>
                                            <th>Interpreta√ß√£o</th>
                                        </tr>
                                    </thead>
                                    <tbody id="subtestResults">
                                        <!-- Os resultados detalhados ser√£o inseridos aqui -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Bot√µes de A√ß√£o -->
                <div class="text-center py-4">
                    <button class="btn btn-primary btn-lg me-3" onclick="generateReport()">Gerar Relat√≥rio PDF</button>
                    <button class="btn btn-success btn-lg me-3" onclick="exportCSV()">Exportar CSV</button>
                    <button class="btn btn-secondary btn-lg me-3" onclick="resetForm()">Limpar Formul√°rio</button>
                    <button class="btn btn-info btn-lg" onclick="printResults()">Imprimir</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <script>
        // Vari√°veis globais para armazenar pontua√ß√µes
        let scores = {
            immediateMemory: 0,
            naming: 0,
            attention: 0,
            workingMemory: 0,
            clockDrawing: 0,
            clockCopy: 0,
            delayedMemory: 0,
            alternatedFluency: 0,
            actionFluency: 0
        };

        let memoryTrials = [0, 0, 0];

        // Nova fun√ß√£o para toggle de itens do rel√≥gio
        function toggleClockItem(container, checkboxId) {
            const checkbox = document.getElementById(checkboxId);
            if (checkbox) {
                checkbox.checked = !checkbox.checked;
                container.classList.toggle('selected', checkbox.checked);
                
                // Chamar a fun√ß√£o de atualiza√ß√£o apropriada
                if (checkboxId.startsWith('clock')) {
                    updateClockScore();
                } else if (checkboxId.startsWith('copy')) {
                    updateCopyScore();
                }
            }
        }

        // Fun√ß√µes para toggle de sele√ß√£o
        function toggleWord(element, trial) {
            element.classList.toggle('selected');
            updateMemoryScore(trial);
        }

        function toggleNaming(element) {
            element.classList.toggle('selected');
            updateNamingScore();
        }

        function toggleAttention(element) {
            element.classList.toggle('selected');
            updateAttentionScore();
        }

        function toggleMemory(element) {
            element.classList.toggle('selected');
            updateWorkingMemoryScore();
        }

        function toggleDelayed(element) {
            element.classList.toggle('selected');
            updateDelayedMemoryScore();
        }

        // Fun√ß√µes de atualiza√ß√£o de pontua√ß√£o
        function updateMemoryScore(trial) {
            const trialIndex = parseInt(trial.slice(-1)) - 1;
            const container = document.getElementById(`memory${trialIndex + 1}`);
            if (!container) return;
            
            const selectedWords = container.querySelectorAll('.word-item.selected');
            memoryTrials[trialIndex] = selectedWords.length;
            
            document.getElementById(`score${trialIndex + 1}`).textContent = memoryTrials[trialIndex];
            
            scores.immediateMemory = Math.max(...memoryTrials);
            document.getElementById('immediateMemoryScore').textContent = scores.immediateMemory;
            
            calculateScores();
        }

        function updateNamingScore() {
            const container = document.querySelector('.naming-grid');
            if (!container) return;
            
            const selectedItems = container.querySelectorAll('.word-item.selected').length;
            scores.naming = selectedItems;
            document.getElementById('namingScore').textContent = scores.naming;
            calculateScores();
        }

        function updateAttentionScore() {
            const selectedItems = document.querySelectorAll('.attention-item.selected').length;
            scores.attention = selectedItems;
            document.getElementById('attentionScore').textContent = scores.attention;
            calculateScores();
        }

        function updateWorkingMemoryScore() {
            const selectedItems = document.querySelectorAll('.memory-item.selected').length;
            scores.workingMemory = selectedItems;
            document.getElementById('workingMemoryScore').textContent = scores.workingMemory;
            calculateScores();
        }

        function updateClockScore() {
            let clockScore = 0;
            for (let i = 1; i <= 10; i++) {
                const checkbox = document.getElementById(`clock${i}`);
                if (checkbox && checkbox.checked) {
                    clockScore++;
                }
            }
            scores.clockDrawing = clockScore;
            document.getElementById('clockDrawingScore').textContent = scores.clockDrawing;
            calculateScores();
        }

        function updateCopyScore() {
            let copyScore = 0;
            for (let i = 1; i <= 10; i++) {
                const checkbox = document.getElementById(`copy${i}`);
                if (checkbox && checkbox.checked) {
                    copyScore++;
                }
            }
            scores.clockCopy = copyScore;
            document.getElementById('clockCopyScore').textContent = scores.clockCopy;
            calculateScores();
        }

        function updateDelayedMemoryScore() {
            const delayedContainer = document.getElementById('delayedMemoryGrid');
            if (!delayedContainer) return;
            
            const selectedWords = delayedContainer.querySelectorAll('.word-item.selected').length;
            scores.delayedMemory = selectedWords;
            document.getElementById('delayedMemoryScore').textContent = scores.delayedMemory;
            calculateScores();
        }

        function updateAlternatedFluency() {
            const input = document.getElementById('alternatedFluency');
            if (!input) return;
            
            const value = parseInt(input.value) || 0;
            scores.alternatedFluency = Math.min(Math.max(value, 0), 20);
            document.getElementById('alternatedFluencyScore').textContent = scores.alternatedFluency;
            calculateScores();
        }

        function updateActionFluency() {
            const input = document.getElementById('actionFluency');
            if (!input) return;
            
            const value = parseInt(input.value) || 0;
            scores.actionFluency = Math.min(Math.max(value, 0), 30);
            document.getElementById('actionFluencyScore').textContent = scores.actionFluency;
            calculateScores();
        }

        // Fun√ß√£o para exportar CSV
        function exportCSV() {
            const patientName = document.getElementById('patientName').value || 'Nao_informado';
            const age = document.getElementById('age').value || '';
            const education = document.getElementById('education').value || '';
            const sex = document.getElementById('sex').value;
            const sexText = sex === '1' ? 'Feminino' : sex === '0' ? 'Masculino' : '';
            
            const frontalScore = parseInt(document.getElementById('frontalScore').textContent);
            const posteriorScore = parseInt(document.getElementById('posteriorScore').textContent);
            const totalScore = parseInt(document.getElementById('totalScore').textContent);
            
            const zScore = document.getElementById('zScore').textContent;
            const tScore = document.getElementById('tScore').textContent;
            const classification = document.getElementById('classification').textContent;
            const clinicalGuidance = document.getElementById('clinicalGuidance').textContent;
            const generalInterpretation = document.getElementById('generalInterpretation').textContent;
            
            // Calcular escores preditos e z-scores por subteste se h√° dados demogr√°ficos
            let predicted = null;
            let subtestZScores = {};
            let subtestPercentiles = {};
            let subtestClassifications = {};
            
            if (age && education !== '' && sex !== '') {
                const ageNum = parseInt(age);
                const educationNum = parseInt(education);
                const sexNum = parseInt(sex);
                
                predicted = calculatePredictedScores(ageNum, educationNum, sexNum);
                
                const subtests = [
                    {name: 'MemoriaImediata', raw: scores.immediateMemory, predicted: predicted.immediateMemory, rmse: rmseValues.immediateMemory},
                    {name: 'Nomeacao', raw: scores.naming, predicted: predicted.naming, rmse: rmseValues.naming},
                    {name: 'AtencaoSustentada', raw: scores.attention, predicted: predicted.attention, rmse: rmseValues.attention},
                    {name: 'MemoriaOperacional', raw: scores.workingMemory, predicted: predicted.workingMemory, rmse: rmseValues.workingMemory},
                    {name: 'DesenhoRelogio', raw: scores.clockDrawing, predicted: predicted.clockDrawing, rmse: rmseValues.clockDrawing},
                    {name: 'CopiaRelogio', raw: scores.clockCopy, predicted: predicted.clockCopy, rmse: rmseValues.clockCopy},
                    {name: 'MemoriaTardia', raw: scores.delayedMemory, predicted: predicted.delayedMemory, rmse: rmseValues.delayedMemory},
                    {name: 'FluenciaAlternada', raw: scores.alternatedFluency, predicted: predicted.alternatedFluency, rmse: rmseValues.alternatedFluency},
                    {name: 'FluenciaAcoes', raw: scores.actionFluency, predicted: predicted.actionFluency, rmse: rmseValues.actionFluency}
                ];
                
                subtests.forEach(subtest => {
                    const subtestZ = (subtest.raw - subtest.predicted) / subtest.rmse;
                    const subtestPercentile = zScoreToPercentile(subtestZ);
                    const subtestClassification = getScoreClassification(subtestPercentile);
                    
                    subtestZScores[subtest.name] = subtestZ.toFixed(2);
                    subtestPercentiles[subtest.name] = subtestPercentile;
                    subtestClassifications[subtest.name] = subtestClassification.label;
                });
            }
            
            // Criar cabe√ßalho do CSV
            const headers = [
                'DataAvaliacao',
                'NomePaciente',
                'Idade',
                'Escolaridade',
                'Sexo',
                'MemoriaImediata_Bruto',
                'Nomeacao_Bruto',
                'AtencaoSustentada_Bruto',
                'MemoriaOperacional_Bruto',
                'DesenhoRelogio_Bruto',
                'CopiaRelogio_Bruto',
                'MemoriaTardia_Bruto',
                'FluenciaAlternada_Bruto',
                'FluenciaAcoes_Bruto',
                'EscoreFrontal',
                'EscorePosterior',
                'EscoreTotal',
                'ZScore_Total',
                'TScore_Total',
                'ClassificacaoAACN',
                'OrientacaoClinica',
                'InterpretacaoGeral'
            ];
            
            // Adicionar cabe√ßalhos para subtestes se h√° dados normativos
            if (predicted) {
                const subtestNames = ['MemoriaImediata', 'Nomeacao', 'AtencaoSustentada', 'MemoriaOperacional', 
                                   'DesenhoRelogio', 'CopiaRelogio', 'MemoriaTardia', 'FluenciaAlternada', 'FluenciaAcoes'];
                
                subtestNames.forEach(name => {
                    headers.push(`${name}_Predito`);
                    headers.push(`${name}_ZScore`);
                    headers.push(`${name}_Percentil`);
                    headers.push(`${name}_Classificacao`);
                });
            }
            
            // Criar linha de dados
            const data = [
                new Date().toLocaleDateString('pt-BR'),
                `"${patientName.replace(/"/g, '""')}"`, // Escapar aspas no nome
                age,
                education,
                sexText,
                scores.immediateMemory,
                scores.naming,
                scores.attention,
                scores.workingMemory,
                scores.clockDrawing,
                scores.clockCopy,
                scores.delayedMemory,
                scores.alternatedFluency,
                scores.actionFluency,
                frontalScore,
                posteriorScore,
                totalScore,
                zScore,
                tScore,
                `"${classification.replace(/"/g, '""')}"`,
                `"${clinicalGuidance.replace(/"/g, '""')}"`,
                `"${generalInterpretation.replace(/"/g, '""')}"`
            ];
            
            // Adicionar dados de subtestes se dispon√≠veis
            if (predicted) {
                const subtestNames = ['MemoriaImediata', 'Nomeacao', 'AtencaoSustentada', 'MemoriaOperacional', 
                                   'DesenhoRelogio', 'CopiaRelogio', 'MemoriaTardia', 'FluenciaAlternada', 'FluenciaAcoes'];
                
                const predictedValues = [
                    predicted.immediateMemory, predicted.naming, predicted.attention, predicted.workingMemory,
                    predicted.clockDrawing, predicted.clockCopy, predicted.delayedMemory, 
                    predicted.alternatedFluency, predicted.actionFluency
                ];
                
                subtestNames.forEach((name, index) => {
                    data.push(predictedValues[index].toFixed(2));
                    data.push(subtestZScores[name] || '');
                    data.push(subtestPercentiles[name] || '');
                    data.push(`"${(subtestClassifications[name] || '').replace(/"/g, '""')}"`);
                });
            }
            
            // Criar conte√∫do CSV
            const csvContent = headers.join(',') + '\n' + data.join(',');
            
            // Criar e baixar arquivo
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            
            const fileName = `PD-CRS_${patientName.replace(/\s+/g, '_')}_${new Date().toISOString().split('T')[0]}.csv`;
            link.setAttribute('download', fileName);
            link.style.visibility = 'hidden';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Fun√ß√µes para classifica√ß√£o baseadas no consenso da AACN
        function getScoreClassification(percentile) {
            if (percentile > 98) return { label: 'Excepcionalmente Superior', class: 'score-exceptionally-high' };
            else if (percentile >= 91) return { label: 'Acima da M√©dia', class: 'score-above-average' };
            else if (percentile >= 75) return { label: 'M√©dia Superior', class: 'score-high-average' };
            else if (percentile >= 25) return { label: 'M√©dia', class: 'score-average' };
            else if (percentile >= 9) return { label: 'M√©dia Inferior', class: 'score-low-average' };
            else if (percentile >= 2) return { label: 'Abaixo da M√©dia', class: 'score-below-average' };
            else return { label: 'Excepcionalmente Inferior', class: 'score-exceptionally-low' };
        }

        function getImpairmentInterpretation(zScore, percentile) {
            if (zScore <= -2.0) return { 
                text: 'Significativamente Comprometido', 
                detail: 'Sugere d√©ficit neuropsicol√≥gico',
                class: 'score-exceptionally-low'
            };
            else if (zScore <= -1.5) return { 
                text: 'Lim√≠trofe/Comprometido', 
                detail: 'Poss√≠vel d√©ficit, avaliar contexto',
                class: 'score-below-average'
            };
            else if (zScore <= -1.0) return { 
                text: 'Abaixo do Esperado', 
                detail: 'Monitoramento recomendado',
                class: 'score-low-average'
            };
            else if (zScore >= 1.5) return { 
                text: 'Superior', 
                detail: 'Desempenho excepcional',
                class: 'score-exceptionally-high'
            };
            else if (zScore >= 0.5) return { 
                text: 'Acima da M√©dia', 
                detail: 'Bom desempenho',
                class: 'score-high-average'
            };
            else return { 
                text: 'Dentro da Normalidade', 
                detail: 'Desempenho preservado',
                class: 'score-average'
            };
        }

        function calculatePredictedScores(age, education, sex) {
            const ageCentered = age - 58.9;
            const ageSquared = age * age;
            const educSqrt = Math.sqrt(education);
            
            return {
                immediateMemory: 10.816 + (0.0561 * ageCentered) - (0.0009 * ageSquared) + (0.1643 * education),
                naming: 12.044 - (0.0002 * ageSquared) + (1.338 * educSqrt),
                attention: 5.4178 - (0.0002 * ageSquared) + (0.945 * educSqrt),
                workingMemory: 2.799 - (0.0282 * ageCentered) + (0.9186 * educSqrt),
                clockDrawing: 5.6848 - (0.0196 * ageCentered) + (0.7315 * educSqrt),
                clockCopy: 8.11 - (0.0138 * ageCentered) + (0.3906 * educSqrt),
                delayedMemory: 7.44 + (0.0787 * ageCentered) - (0.0012 * ageSquared) + (0.1818 * education) + (0.5863 * sex),
                alternatedFluency: 6.444 - (0.0005 * ageSquared) + (1.5205 * educSqrt),
                actionFluency: 8.962 - (0.0004 * ageSquared) + (0.4709 * education),
                frontalSubcortical: 35.822 - (0.0024 * ageSquared) + (9.213 * educSqrt),
                posteriorCortical: 20.496 - (0.0003 * ageSquared) + (1.773 * educSqrt),
                total: 55.766 - (0.0028 * ageSquared) + (11.152 * educSqrt)
            };
        }

        // RMSEs das regress√µes para c√°lculo dos z-scores
        const rmseValues = {
            immediateMemory: 1.932,
            naming: 2.963,
            attention: 2.023,
            workingMemory: 1.912,
            clockDrawing: 1.789,
            clockCopy: 0.798,
            delayedMemory: 2.207,
            alternatedFluency: 3.575,
            actionFluency: 4.374,
            frontalSubcortical: 11.21,
            posteriorCortical: 3.259,
            total: 13.15
        };

        function calculateScores() {
            const ageInput = document.getElementById('age');
            const educationInput = document.getElementById('education');
            const sexInput = document.getElementById('sex');
            
            if (!ageInput || !educationInput || !sexInput) return;
            
            const age = parseInt(ageInput.value);
            const education = parseInt(educationInput.value);
            const sex = parseInt(sexInput.value);

            // Calcular escores compostos independentemente dos dados demogr√°ficos
            const frontalScore = scores.immediateMemory + scores.attention + scores.workingMemory + 
                               scores.clockDrawing + scores.delayedMemory + scores.alternatedFluency + 
                               scores.actionFluency;
            
            const posteriorScore = scores.naming + scores.clockCopy;
            const totalScore = frontalScore + posteriorScore;

            // Atualizar exibi√ß√£o dos escores sempre
            document.getElementById('frontalScore').textContent = frontalScore;
            document.getElementById('posteriorScore').textContent = posteriorScore;
            document.getElementById('totalScore').textContent = totalScore;

            // Se n√£o temos dados demogr√°ficos completos, parar aqui
            if (!age || education === '' || sex === '' || isNaN(age) || isNaN(education) || isNaN(sex)) {
                document.getElementById('zScore').textContent = '--';
                document.getElementById('tScore').textContent = '--';
                document.getElementById('totalPercentile').textContent = 'Percentil: --';
                document.getElementById('frontalPercentile').textContent = 'Percentil: --';
                document.getElementById('posteriorPercentile').textContent = 'Percentil: --';
                document.getElementById('classification').textContent = '--';
                document.getElementById('clinicalGuidance').textContent = '--';
                document.getElementById('generalInterpretation').textContent = 'Insira dados demogr√°ficos para an√°lise normativa';
                
                document.getElementById('subtestResults').innerHTML = '';
                return;
            }

            // Calcular escores preditos
            const predicted = calculatePredictedScores(age, education, sex);

            // Calcular z-scores
            const zScores = {
                total: (totalScore - predicted.total) / rmseValues.total,
                frontal: (frontalScore - predicted.frontalSubcortical) / rmseValues.frontalSubcortical,
                posterior: (posteriorScore - predicted.posteriorCortical) / rmseValues.posteriorCortical
            };

            // Calcular T-scores (m√©dia 50, DP 10)
            const tScores = {
                total: 50 + (zScores.total * 10),
                frontal: 50 + (zScores.frontal * 10),
                posterior: 50 + (zScores.posterior * 10)
            };

            // Calcular percentis
            const percentiles = {
                total: zScoreToPercentile(zScores.total),
                frontal: zScoreToPercentile(zScores.frontal),
                posterior: zScoreToPercentile(zScores.posterior)
            };

            // Atualizar exibi√ß√£o
            document.getElementById('zScore').textContent = zScores.total.toFixed(2);
            document.getElementById('tScore').textContent = tScores.total.toFixed(1);
            document.getElementById('totalPercentile').textContent = `Percentil: ${percentiles.total}`;
            document.getElementById('frontalPercentile').textContent = `Percentil: ${percentiles.frontal}`;
            document.getElementById('posteriorPercentile').textContent = `Percentil: ${percentiles.posterior}`;

            // Classifica√ß√£o baseada no consenso AACN
            let classification = '';
            let clinicalGuidance = '';
            
            if (zScores.total >= 1.5) {
                classification = 'Superior (Exceptionally High)';
                clinicalGuidance = 'Desempenho excepcional, acima do percentil 98';
            } else if (zScores.total >= 0.5) {
                classification = 'Acima da M√©dia (High Average)';
                clinicalGuidance = 'Bom desempenho cognitivo';
            } else if (zScores.total >= -0.5) {
                classification = 'M√©dio (Average)';
                clinicalGuidance = 'Desempenho dentro da normalidade';
            } else if (zScores.total >= -1.0) {
                classification = 'Abaixo do Esperado (Low Average)';
                clinicalGuidance = 'Monitoramento recomendado';
            } else if (zScores.total >= -1.5) {
                classification = 'Lim√≠trofe (Below Average)';
                clinicalGuidance = 'Poss√≠vel d√©ficit, avaliar contexto cl√≠nico';
            } else if (zScores.total >= -2.0) {
                classification = 'Comprometido (Exceptionally Low)';
                clinicalGuidance = 'Sugere d√©ficit neuropsicol√≥gico significativo';
            } else {
                classification = 'Severamente Comprometido';
                clinicalGuidance = 'D√©ficit neuropsicol√≥gico severo';
            }

            document.getElementById('classification').textContent = classification;
            document.getElementById('clinicalGuidance').textContent = clinicalGuidance;

            // Interpreta√ß√£o geral baseada na classifica√ß√£o AACN
            let generalInterpretation = '';
            if (zScores.total >= 1.5) {
                generalInterpretation = 'Funcionamento cognitivo excepcional, muito acima da m√©dia populacional';
            } else if (zScores.total >= 0.5) {
                generalInterpretation = 'Funcionamento cognitivo preservado, acima da m√©dia';
            } else if (zScores.total >= -0.5) {
                generalInterpretation = 'Funcionamento cognitivo dentro dos limites esperados';
            } else if (zScores.total >= -1.0) {
                generalInterpretation = 'Funcionamento cognitivo no limite inferior da normalidade';
            } else if (zScores.total >= -1.5) {
                generalInterpretation = 'Funcionamento cognitivo abaixo do esperado, requer avalia√ß√£o adicional';
            } else {
                generalInterpretation = 'Funcionamento cognitivo significativamente comprometido';
            }
            
            document.getElementById('generalInterpretation').textContent = generalInterpretation;

            // Preencher tabela detalhada
            updateSubtestTable(predicted, zScores);
        }

        function zScoreToPercentile(zScore) {
            // Aproxima√ß√£o da fun√ß√£o de distribui√ß√£o normal cumulativa
            const t = 1 / (1 + 0.2316419 * Math.abs(zScore));
            const d = 0.3989423 * Math.exp(-zScore * zScore / 2);
            let prob = d * t * (0.3193815 + t * (-0.3565638 + t * (1.781478 + t * (-1.821256 + t * 1.330274))));
            
            if (zScore > 0) prob = 1 - prob;
            
            return Math.round(prob * 100);
        }

        function updateSubtestTable(predicted, zScores) {
            const subtests = [
                {name: 'Mem√≥ria Verbal Imediata', raw: scores.immediateMemory, predicted: predicted.immediateMemory, max: 12, rmse: rmseValues.immediateMemory},
                {name: 'Nomea√ß√£o', raw: scores.naming, predicted: predicted.naming, max: 20, rmse: rmseValues.naming},
                {name: 'Aten√ß√£o Sustentada', raw: scores.attention, predicted: predicted.attention, max: 10, rmse: rmseValues.attention},
                {name: 'Mem√≥ria Operacional', raw: scores.workingMemory, predicted: predicted.workingMemory, max: 10, rmse: rmseValues.workingMemory},
                {name: 'Desenho do Rel√≥gio', raw: scores.clockDrawing, predicted: predicted.clockDrawing, max: 10, rmse: rmseValues.clockDrawing},
                {name: 'C√≥pia do Rel√≥gio', raw: scores.clockCopy, predicted: predicted.clockCopy, max: 10, rmse: rmseValues.clockCopy},
                {name: 'Mem√≥ria Verbal Tardia', raw: scores.delayedMemory, predicted: predicted.delayedMemory, max: 12, rmse: rmseValues.delayedMemory},
                {name: 'Flu√™ncia Alternada', raw: scores.alternatedFluency, predicted: predicted.alternatedFluency, max: 20, rmse: rmseValues.alternatedFluency},
                {name: 'Flu√™ncia de A√ß√µes', raw: scores.actionFluency, predicted: predicted.actionFluency, max: 30, rmse: rmseValues.actionFluency}
            ];

            const tbody = document.getElementById('subtestResults');
            if (!tbody) return;
            
            tbody.innerHTML = '';

            subtests.forEach(subtest => {
                const zScore = (subtest.raw - subtest.predicted) / subtest.rmse;
                const percentile = zScoreToPercentile(zScore);
                const classification = getScoreClassification(percentile);
                const interpretation = getImpairmentInterpretation(zScore, percentile);
                
                const row = tbody.insertRow();
                row.className = classification.class;
                row.innerHTML = `
                    <td><strong>${subtest.name}</strong></td>
                    <td>${subtest.raw}/${subtest.max}</td>
                    <td>${subtest.predicted.toFixed(1)}</td>
                    <td>${zScore.toFixed(2)}</td>
                    <td>${percentile}</td>
                    <td><strong>${classification.label}</strong></td>
                    <td>${interpretation.text}</td>
                `;
            });
        }

        function generateReport() {
            const patientName = document.getElementById('patientName').value || 'N√£o informado';
            const age = document.getElementById('age').value || 'N√£o informado';
            const education = document.getElementById('education').value || 'N√£o informado';
            const sex = document.getElementById('sex').value === '1' ? 'Feminino' : 
                       document.getElementById('sex').value === '0' ? 'Masculino' : 'N√£o informado';
            
            const totalScore = parseInt(document.getElementById('totalScore').textContent);
            const frontalScore = parseInt(document.getElementById('frontalScore').textContent);
            const posteriorScore = parseInt(document.getElementById('posteriorScore').textContent);
            
            const zScore = document.getElementById('zScore').textContent;
            const tScore = document.getElementById('tScore').textContent;
            const classification = document.getElementById('classification').textContent;
            const clinicalGuidance = document.getElementById('clinicalGuidance').textContent;
            const generalInterpretation = document.getElementById('generalInterpretation').textContent;

            // Verificar se jsPDF est√° dispon√≠vel
            if (typeof window.jspdf === 'undefined') {
                alert('Erro: Biblioteca jsPDF n√£o carregada. Verifique a conex√£o com a internet.');
                return;
            }

            // Criar PDF usando jsPDF
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            // Configura√ß√£o da fonte
            doc.setFont("helvetica");
            
            // T√≠tulo
            doc.setFontSize(16);
            doc.setFont("helvetica", "bold");
            doc.text("RELAT√ìRIO PD-CRS", 20, 20);
            doc.setFontSize(12);
            doc.text("Escala de Avalia√ß√£o Cognitiva da Doen√ßa de Parkinson", 20, 30);
            
            // Linha divis√≥ria
            doc.line(20, 35, 190, 35);
            
            // Dados do paciente
            doc.setFont("helvetica", "bold");
            doc.setFontSize(14);
            doc.text("DADOS DO PACIENTE:", 20, 45);
            
            doc.setFont("helvetica", "normal");
            doc.setFontSize(11);
            doc.text(`Nome: ${patientName}`, 20, 55);
            doc.text(`Idade: ${age} anos`, 20, 62);
            doc.text(`Escolaridade: ${education} anos`, 20, 69);
            doc.text(`Sexo: ${sex}`, 20, 76);
            doc.text(`Data da Avalia√ß√£o: ${new Date().toLocaleDateString('pt-BR')}`, 20, 83);
            
            // Resultados principais
            doc.setFont("helvetica", "bold");
            doc.setFontSize(14);
            doc.text("RESULTADOS PRINCIPAIS:", 20, 100);
            
            doc.setFont("helvetica", "normal");
            doc.setFontSize(11);
            doc.text(`Escore Frontal-Subcortical: ${frontalScore}/104`, 20, 110);
            doc.text(`Escore Cortical Posterior: ${posteriorScore}/30`, 20, 117);
            doc.text(`Escore Total PD-CRS: ${totalScore}/134`, 20, 124);
            
            if (zScore !== '--') {
                doc.text(`Z-Score Total: ${zScore}`, 20, 131);
                doc.text(`T-Score Total: ${tScore}`, 20, 138);
                doc.text(`Classifica√ß√£o AACN: ${classification}`, 20, 145);
                doc.text(`Orienta√ß√£o Cl√≠nica: ${clinicalGuidance}`, 20, 152);
            }
            
            doc.text(`Interpreta√ß√£o Geral: ${generalInterpretation}`, 20, 159);
            
            // Detalhamento por subteste
            doc.setFont("helvetica", "bold");
            doc.setFontSize(14);
            doc.text("DETALHAMENTO POR SUBTESTE:", 20, 177);
            
            doc.setFont("helvetica", "normal");
            doc.setFontSize(10);
            
            const subtestData = [
                `1. Mem√≥ria Verbal Imediata: ${scores.immediateMemory}/12`,
                `2. Nomea√ß√£o por Confronto Visual: ${scores.naming}/20`,
                `3. Aten√ß√£o Sustentada: ${scores.attention}/10`,
                `4. Mem√≥ria Operacional: ${scores.workingMemory}/10`,
                `5. Desenho do Rel√≥gio: ${scores.clockDrawing}/10`,
                `6. C√≥pia do Rel√≥gio: ${scores.clockCopy}/10`,
                `7. Mem√≥ria Verbal Tardia: ${scores.delayedMemory}/12`,
                `8. Flu√™ncia Verbal Alternada: ${scores.alternatedFluency}/20`,
                `9. Flu√™ncia Verbal de A√ß√µes: ${scores.actionFluency}/30`
            ];
            
            let yPosition = 187;
            subtestData.forEach(item => {
                doc.text(item, 20, yPosition);
                yPosition += 7;
            });

            // An√°lise detalhada por subteste (se h√° dados normativos)
            if (zScore !== '--') {
                const ageNum = parseInt(document.getElementById('age').value);
                const educationNum = parseInt(document.getElementById('education').value);
                const sexNum = parseInt(document.getElementById('sex').value);
                
                if (!isNaN(ageNum) && !isNaN(educationNum) && !isNaN(sexNum)) {
                    const predicted = calculatePredictedScores(ageNum, educationNum, sexNum);

                    doc.setFont("helvetica", "bold");
                    doc.setFontSize(12);
                    doc.text("AN√ÅLISE NORMATIVA DETALHADA:", 20, yPosition + 10);
                    yPosition += 20;

                    const subtests = [
                        {name: 'Mem√≥ria Verbal Imediata', raw: scores.immediateMemory, predicted: predicted.immediateMemory, rmse: rmseValues.immediateMemory},
                        {name: 'Nomea√ß√£o', raw: scores.naming, predicted: predicted.naming, rmse: rmseValues.naming},
                        {name: 'Aten√ß√£o Sustentada', raw: scores.attention, predicted: predicted.attention, rmse: rmseValues.attention},
                        {name: 'Mem√≥ria Operacional', raw: scores.workingMemory, predicted: predicted.workingMemory, rmse: rmseValues.workingMemory},
                        {name: 'Desenho do Rel√≥gio', raw: scores.clockDrawing, predicted: predicted.clockDrawing, rmse: rmseValues.clockDrawing},
                        {name: 'C√≥pia do Rel√≥gio', raw: scores.clockCopy, predicted: predicted.clockCopy, rmse: rmseValues.clockCopy},
                        {name: 'Mem√≥ria Verbal Tardia', raw: scores.delayedMemory, predicted: predicted.delayedMemory, rmse: rmseValues.delayedMemory},
                        {name: 'Flu√™ncia Alternada', raw: scores.alternatedFluency, predicted: predicted.alternatedFluency, rmse: rmseValues.alternatedFluency},
                        {name: 'Flu√™ncia de A√ß√µes', raw: scores.actionFluency, predicted: predicted.actionFluency, rmse: rmseValues.actionFluency}
                    ];

                    doc.setFont("helvetica", "normal");
                    doc.setFontSize(9);

                    subtests.forEach(subtest => {
                        const subtestZ = (subtest.raw - subtest.predicted) / subtest.rmse;
                        const subtestPercentile = zScoreToPercentile(subtestZ);
                        const interpretation = getImpairmentInterpretation(subtestZ, subtestPercentile);
                        
                        if (yPosition > 260) {
                            doc.addPage();
                            yPosition = 20;
                        }
                        
                        doc.text(`${subtest.name}: Z=${subtestZ.toFixed(2)}, P=${subtestPercentile}, ${interpretation.text}`, 20, yPosition);
                        yPosition += 6;
                    });
                }
            }
            
            // Interpreta√ß√£o cl√≠nica
            if (yPosition > 240) {
                doc.addPage();
                yPosition = 20;
            }

            doc.setFont("helvetica", "bold");
            doc.setFontSize(12);
            doc.text("INTERPRETA√á√ÉO CL√çNICA:", 20, yPosition + 10);
            
            doc.setFont("helvetica", "normal");
            doc.setFontSize(10);
            yPosition += 20;
            
            // Interpreta√ß√£o baseada na classifica√ß√£o AACN
            if (zScore !== '--') {
                const zScoreNum = parseFloat(zScore);
                if (zScoreNum <= -1.5) {
                    doc.text("‚Ä¢ Escores com Z ‚â§ -1.5 sugerem comprometimento significativo conforme", 20, yPosition);
                    yPosition += 7;
                    doc.text("  crit√©rios da AACN (American Academy of Clinical Neuropsychology).", 20, yPosition);
                    yPosition += 7;
                    doc.text("‚Ä¢ Recomenda-se avalia√ß√£o neuropsicol√≥gica completa e", 20, yPosition);
                    yPosition += 7;
                    doc.text("  acompanhamento cl√≠nico especializado.", 20, yPosition);
                } else if (zScoreNum <= -1.0) {
                    doc.text("‚Ä¢ Funcionamento cognitivo no limite inferior da normalidade.", 20, yPosition);
                    yPosition += 7;
                    doc.text("‚Ä¢ Monitoramento cl√≠nico recomendado.", 20, yPosition);
                } else {
                    doc.text("‚Ä¢ Funcionamento cognitivo dentro dos par√¢metros esperados", 20, yPosition);
                    yPosition += 7;
                    doc.text("  conforme normas da popula√ß√£o brasileira.", 20, yPosition);
                }
            } else {
                doc.text("‚Ä¢ Para interpreta√ß√£o normativa completa, incluir dados demogr√°ficos.", 20, yPosition);
            }
            
            // Rodap√©
            doc.setFontSize(8);
            doc.setFont("helvetica", "italic");
            doc.text("Relat√≥rio gerado automaticamente pelo sistema PD-CRS.", 20, 280);
            doc.text("Baseado nas normas brasileiras (Brand√£o et al., 2023) e crit√©rios AACN (2020).", 20, 285);
            
            // Salvar PDF
            const fileName = `PD-CRS_${patientName.replace(/\s+/g, '_')}_${new Date().toISOString().split('T')[0]}.pdf`;
            doc.save(fileName);
        }

        function resetForm() {
            if (confirm('Tem certeza que deseja limpar todos os dados?')) {
                // Resetar todos os campos de entrada
                document.querySelectorAll('input[type="text"], input[type="number"]').forEach(input => {
                    input.value = '';
                });

                // Resetar select
                document.querySelectorAll('select').forEach(select => {
                    select.value = '';
                });

                // Resetar checkboxes e suas visualiza√ß√µes
                document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                    checkbox.checked = false;
                });
                
                // Resetar classes visuais das checkboxes
                document.querySelectorAll('.clock-checkbox-item').forEach(item => {
                    item.classList.remove('selected');
                });

                // Resetar sele√ß√µes
                document.querySelectorAll('.word-item, .attention-item, .memory-item').forEach(item => {
                    item.classList.remove('selected');
                });

                // Resetar escores
                scores = {
                    immediateMemory: 0,
                    naming: 0,
                    attention: 0,
                    workingMemory: 0,
                    clockDrawing: 0,
                    clockCopy: 0,
                    delayedMemory: 0,
                    alternatedFluency: 0,
                    actionFluency: 0
                };

                memoryTrials = [0, 0, 0];

                // Atualizar exibi√ß√µes
                const scoreElements = [
                    'score1', 'score2', 'score3',
                    'immediateMemoryScore', 'namingScore', 'attentionScore',
                    'workingMemoryScore', 'clockDrawingScore', 'clockCopyScore',
                    'delayedMemoryScore', 'alternatedFluencyScore', 'actionFluencyScore',
                    'frontalScore', 'posteriorScore', 'totalScore'
                ];

                scoreElements.forEach(id => {
                    const element = document.getElementById(id);
                    if (element) element.textContent = '0';
                });

                // Resetar elementos normativos
                const resetElements = [
                    { id: 'zScore', value: '--' },
                    { id: 'tScore', value: '--' },
                    { id: 'classification', value: '--' },
                    { id: 'clinicalGuidance', value: '--' },
                    { id: 'generalInterpretation', value: '--' },
                    { id: 'totalPercentile', value: 'Percentil: --' },
                    { id: 'frontalPercentile', value: 'Percentil: --' },
                    { id: 'posteriorPercentile', value: 'Percentil: --' }
                ];

                resetElements.forEach(item => {
                    const element = document.getElementById(item.id);
                    if (element) element.textContent = item.value;
                });

                // Limpar tabela de resultados
                const subtestResults = document.getElementById('subtestResults');
                if (subtestResults) subtestResults.innerHTML = '';
            }
        }

        function printResults() {
            window.print();
        }

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            // Garantir que todos os escores iniciem em 0
            calculateScores();
            
            // Sincronizar checkboxes com visualiza√ß√£o na inicializa√ß√£o
            document.querySelectorAll('.clock-checkbox-item').forEach(item => {
                const checkbox = item.querySelector('input[type="checkbox"]');
                if (checkbox) {
                    item.classList.toggle('selected', checkbox.checked);
                }
            });
        });
    </script>
</body>
</html>
                
